{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _syncStorage = _interopRequireDefault(require(\"sync-storage\"));\n\nvar _WooComFetch = require(\"../../common/WooComFetch\");\n\nvar _this = this;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[typeof Symbol === \"function\" ? Symbol.iterator : \"@@iterator\"] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[typeof Symbol === \"function\" ? Symbol.iterator : \"@@iterator\"](); return it.next.bind(it); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar initialState = {\n  wishListProducts: [],\n  recentViewedProducts: [],\n  tempArr: [],\n  cartProductArray: [],\n  cartquantity: 0,\n  subTotal: [],\n  totalSumPrice: 0,\n  spinerTemp: false,\n  indicatorTemp: false,\n  spinnerArray: [],\n  removerecentCondition: false,\n  onScreen: false,\n  couponArray: [],\n  allCategories: [],\n  categories: [],\n  subCategories: [],\n  sectionlist: [],\n  productDeleteId: 0,\n  productErrorMsg: '',\n  check: false\n};\n\nremoveHtmlEntites = function removeHtmlEntites(value) {\n  var multiple = {\n    '&nbsp;': ' ',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&amp;': '&',\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&cent;': '¢',\n    '&pound;': '£',\n    '&yen;': '¥',\n    '&euro;': '€',\n    '&copy;': '©',\n    '&reg;': '®',\n    '&#160;': ' ',\n    '&#60;': '<',\n    '&#62;': '>',\n    '&#38;': '&',\n    '&#34;': '\"',\n    '&#39;': \"'\",\n    '&#162;': '¢',\n    '&#163;': '£',\n    '&#165;': '¥',\n    '&#8364;': '€',\n    '&#169;': '©',\n    '&#174;': '®'\n  };\n\n  for (var char in multiple) {\n    var before = char;\n    var after = multiple[char];\n    var pattern = new RegExp(before, 'g');\n    value = value.replace(pattern, after);\n  }\n\n  return value;\n};\n\ngetAllCategories = function getAllCategories(page, state, formData) {\n  var data, dat, _iterator, _step, value, CHILD;\n\n  return _regenerator.default.async(function getAllCategories$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          state.allCategories = [];\n          state.categories = [];\n          _context.next = 4;\n          return _regenerator.default.awrap((0, _WooComFetch.postHttp)((0, _WooComFetch.getUrl)() + '/api/' + 'allcategories', formData));\n\n        case 4:\n          data = _context.sent;\n          dat = data.data;\n\n          for (_iterator = _createForOfIteratorHelperLoose(dat); !(_step = _iterator()).done;) {\n            value = _step.value;\n            value.name = value.categories_name;\n            value.id = value.categories_id;\n            state.allCategories.push(value);\n\n            if (value.parent_id === 0) {\n              state.categories.push(value);\n            } else {\n              state.subCategories.push(value);\n            }\n          }\n\n          if (dat.length === 0) {}\n\n          if (state.categories === undefined || state.categories.length === 0) {} else {\n            CHILD = [];\n            state.categories.map(function (key) {\n              for (var _iterator2 = _createForOfIteratorHelperLoose(state.allCategories), _step2; !(_step2 = _iterator2()).done;) {\n                var _value = _step2.value;\n\n                if (_value.parent_id === key.categories_id) {\n                  CHILD.push(_value);\n                }\n              }\n\n              state.sectionlist.push({\n                data: CHILD,\n                parent: key\n              });\n              CHILD = [];\n            });\n          }\n\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nsaveLocalDataIntoArrays = function saveLocalDataIntoArrays(state) {\n  state.cartProductArray = [];\n\n  var val = _syncStorage.default.getAllKeys().includes('cartProducts');\n\n  if (val != null) {\n    var tempArray = _syncStorage.default.get('cartProducts');\n\n    if (tempArray != null) {\n      tempArray.map(function (row) {\n        state.cartProductArray.push(row);\n\n        _this.cartTotalItems(state);\n\n        _this.productsTotal(state);\n      });\n    }\n  }\n};\n\nremoveWishList = function removeWishList(p, state) {\n  state.wishListProducts.forEach(function (value, index) {\n    if (value.id === p.id) {\n      state.wishListProducts.splice(index, 1);\n\n      _syncStorage.default.set('wishListProducts', state.wishListProducts);\n    }\n  });\n};\n\naddWishList = function addWishList(p, state) {\n  state.wishListProducts.push(p);\n\n  _syncStorage.default.set('wishListProducts', state.wishListProducts);\n};\n\naddToRecent = function addToRecent(p, state) {\n  if (state.recentViewedProducts === undefined) {\n    state.recentViewedProducts.push(p);\n    state.tempArr.push(p.products_id);\n\n    _syncStorage.default.set('recentViewedProducts', state.tempArr);\n  } else {\n    var found = false;\n\n    for (var _iterator3 = _createForOfIteratorHelperLoose(state.recentViewedProducts), _step3; !(_step3 = _iterator3()).done;) {\n      var value = _step3.value;\n\n      if (value.id === p.id) {\n        found = true;\n      }\n    }\n\n    if (found === false) {\n      state.recentViewedProducts.push(p);\n      state.tempArr.push(p.products_id);\n\n      _syncStorage.default.set('recentViewedProducts', state.tempArr);\n    }\n  }\n};\n\nremoveRecent = function removeRecent(p, state) {\n  state.recentViewedProducts.forEach(function (value, index) {\n    if (value.id === p.id) {\n      state.recentViewedProducts.splice(index, 1);\n\n      _syncStorage.default.set('recentViewedProducts', state.recentViewedProducts);\n    }\n  });\n};\n\nconvertHtmlTag = function convertHtmlTag(htmlprice) {\n  var s = htmlprice;\n  s = s.replace(/<del>/, '<s>');\n  s = s.replace(/<\\/del>/, '</s>');\n  return s;\n};\n\naddToCart = function addToCart(state, product, attArray, t, productQuantity) {\n  var attributesArray = attArray;\n\n  if (attArray.length === 0 || attArray == null) {\n    attributesArray = [];\n\n    if (product.attributes !== undefined) {\n      product.attributes.forEach(function (value, index) {\n        var att = {\n          products_options_id: value.option.id,\n          products_options: value.option.name,\n          products_options_values_id: value.values[0].id,\n          options_values_price: value.values[0].price,\n          price_prefix: value.values[0].price_prefix,\n          products_options_values: value.values[0].value,\n          name: value.values[0].value + ' ' + value.values[0].price_prefix + value.values[0].price + ' ' + _syncStorage.default.get('currency')\n        };\n        attributesArray.push(att);\n      });\n    }\n  }\n\n  var pprice = product.products_price;\n  var onSale = false;\n\n  if (product.discount_price != null) {\n    pprice = product.discount_price;\n    onSale = true;\n  }\n\n  if (product.flash_price != null) {\n    pprice = product.flash_price;\n  }\n\n  var finalPrice = t.calculateFinalPriceService(attributesArray) + parseFloat(pprice);\n  var obj = {\n    cart_id: parseInt(product.products_id.toString() + state.cartProductArray.length.toString()),\n    products_id: product.products_id,\n    manufacture: product.manufacturers_name,\n    customers_basket_quantity: 1,\n    final_price: finalPrice,\n    model: product.products_model,\n    categories: product.categories,\n    weight: product.products_weight,\n    on_sale: onSale,\n    unit: product.products_weight_unit,\n    image: product.products_image,\n    attributes: attributesArray,\n    products_name: product.products_name,\n    price: pprice,\n    subtotal: finalPrice,\n    total: finalPrice\n  };\n  state.cartProductArray.push(obj);\n  t.cartTotalItems(state);\n\n  _syncStorage.default.set('cartProducts', state.cartProductArray);\n};\n\ncalculateFinalPriceService = function calculateFinalPriceService(attArray) {\n  var total = 0;\n  attArray.forEach(function (value, index) {\n    var attPrice = parseFloat(value.options_values_price);\n\n    if (value.price_prefix === '+') {\n      total += attPrice;\n    } else {\n      total -= attPrice;\n    }\n  });\n  return total;\n};\n\nalreadyInCart = function alreadyInCart(state, p, vId, quantity) {\n  var count = 0;\n\n  for (var _iterator4 = _createForOfIteratorHelperLoose(state.cartProductArray), _step4; !(_step4 = _iterator4()).done;) {\n    var value = _step4.value;\n\n    if (p.type !== 'variable' && value.product_id === Number(p.id)) {\n      count++;\n      value.quantity = Number(value.quantity) + Number(quantity);\n    } else if (value.product_id == Number(p.id) && value.variation_id == Number(p.id)) {\n      count++;\n      value.quantity = Number(value.quantity) + Number(quantity);\n    }\n  }\n\n  _this.cartTotalItems(state);\n\n  _this.productsTotal(state);\n\n  _syncStorage.default.set('cartProducts', state.cartProductArray);\n\n  if (count !== 0) return true;\n  return false;\n};\n\ncheckCart = function checkCart(state, p, quantity) {\n  var name = null;\n  var onlyOneAllowed = true;\n  var quantityCheck = true;\n\n  for (var _iterator5 = _createForOfIteratorHelperLoose(state.cartProductArray), _step5; !(_step5 = _iterator5()).done;) {\n    var value = _step5.value;\n\n    if (value.sold_individually == true && p.id == value.product_id) {\n      onlyOneAllowed = false;\n      name = value.name;\n    }\n  }\n\n  if (onlyOneAllowed === false) console.log(\"'Only One Item Allowed'\");\n  if (quantity == null) quantity = 1;\n\n  if (p.stock_quantity == null || p.stock_quantity > quantity) {\n    quantityCheck = true;\n  } else if (p.stock_quantity < quantity) {\n    quantityCheck = false;\n  }\n\n  if (onlyOneAllowed && quantityCheck) return true;\n  return false;\n};\n\ncartTotalItems = function cartTotalItems(state) {\n  var total = 0;\n\n  for (var _iterator6 = _createForOfIteratorHelperLoose(state.cartProductArray), _step6; !(_step6 = _iterator6()).done;) {\n    var value = _step6.value;\n    total += Number(value.customers_basket_quantity);\n  }\n\n  state.cartquantity = total;\n  return total;\n};\n\nproductsTotal = function productsTotal(state) {\n  var total = 0;\n  state.cartProductArray.map(function (val, key) {\n    state.cartProductArray[key].subTotal = parseFloat(val.quantity * val.price);\n    total += parseFloat(state.cartProductArray[key].subTotal);\n  });\n  state.totalSumPrice = parseFloat(total);\n};\n\nvar cartItems = function cartItems() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case 'GET_ALL_CATEGORIES':\n      _this.getAllCategories(1, state, action.payload);\n\n      return _objectSpread({}, state);\n\n    case 'SPLICE':\n      state.cartProductArray.splice(action.index, 1);\n      return _objectSpread({}, state);\n\n    case 'CART_TOTAL_ITEMS':\n      _this.cartTotalItems(state);\n\n      return _objectSpread({}, state);\n\n    case 'PRODUCT_TOTAL':\n      _this.productsTotal(state);\n\n      return _objectSpread({}, state);\n\n    case 'UPDATE_PRODUCTS':\n      state.cartProductArray = [action.product];\n      return _objectSpread({}, state);\n\n    case 'REMOVE_WISHLIST_PRODUCTS':\n      _this.removeWishList(action.product, state);\n\n      return _objectSpread({}, state);\n\n    case 'ADD_WISHLIST_PRODUCTS':\n      _this.addWishList(action.product, state);\n\n      return _objectSpread({}, state);\n\n    case 'REMOVE_RECENT':\n      _this.removeRecent(action.product, state);\n\n      return _objectSpread({}, state);\n\n    case 'ADD_RECENT':\n      _this.addToRecent(action.product, state);\n\n      return _objectSpread({}, state);\n\n    case 'SAVE_LOCAL_DATA_INTO_ARRAYS':\n      _this.saveLocalDataIntoArrays(state);\n\n      return _objectSpread({}, state);\n\n    case 'REMOVE_SPINNER':\n      state.spinnerArray.map(function (val, key) {\n        state.spinnerArray[key] = null;\n      });\n      state.spinnerArray = [];\n      return _objectSpread({}, state);\n\n    case 'MY_SPINNER':\n      state.spinnerArray[action.index1] = action.value;\n      return _objectSpread({}, state);\n\n    case 'SET_INDICATOR':\n      state.indicatorTemp = action.value;\n      state.onScreen = action.OnScreen;\n      return _objectSpread({}, state);\n\n    case 'SET_SPINNER':\n      state.spinerTemp = action.value;\n      return _objectSpread({}, state);\n\n    case 'ADD_TO_CARTS':\n      _this.addToCart(state, action.product, action.attributes, _this, action.productQuantity);\n\n      return _objectSpread({}, state);\n\n    case 'CLEAR_RECENT_PRODUCT':\n      state.recentViewedProducts = [];\n      return _objectSpread({}, state);\n\n    case 'OUT_OF_STOCK_PRODUCT':\n      state.productDeleteId = action.productDeleteId;\n      state.productErrorMsg = action.msg;\n      state.check = action.check;\n      return _objectSpread({}, state);\n\n    case 'SET_CHECK':\n      state.check = false;\n      return _objectSpread({}, state);\n\n    case 'CLEAR_CART':\n      state.cartProductArray = [];\n      return _objectSpread({}, state);\n\n    case 'ADD_TO_CARTS_QUANTITY':\n      state.cartProductArray.map(function (val, key) {\n        if (val.cart_id === action.product.cart_id) {\n          state.cartProductArray[key].quantity++;\n        }\n      });\n\n      _this.cartTotalItems(state);\n\n      _this.productsTotal(state);\n\n      _syncStorage.default.set('cartProducts', state.cartProductArray);\n\n      return _objectSpread({}, state);\n\n    case 'REMOVE_TO_CARTS_QUANTITY':\n      state.cartProductArray.map(function (val, key) {\n        if (val.cart_id === action.product.cart_id) {\n          state.cartProductArray[key].quantity--;\n        }\n      });\n\n      _this.cartTotalItems(state);\n\n      _this.productsTotal(state);\n\n      _syncStorage.default.set('cartProducts', state.cartProductArray);\n\n      return _objectSpread({}, state);\n\n    case 'REMOVE_CARD_FROM_CART':\n      state.cartProductArray = state.cartProductArray.filter(function (cartItem) {\n        return cartItem.cart_id !== action.product.cart_id;\n      });\n\n      _this.cartTotalItems(state);\n\n      _this.productsTotal(state);\n\n      _syncStorage.default.set('cartProducts', state.cartProductArray);\n\n      return _objectSpread({}, state);\n  }\n\n  return state;\n};\n\nvar _default = cartItems;\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/mysiew/Documents/eCommerce/codecanyon-xPJMYS8x-react-native-delivery-solution-with-advance-website-and-cms/SourceCode/vesend-consumer-app-master/src/redux/reducers/cartItems.js"],"names":["initialState","wishListProducts","recentViewedProducts","tempArr","cartProductArray","cartquantity","subTotal","totalSumPrice","spinerTemp","indicatorTemp","spinnerArray","removerecentCondition","onScreen","couponArray","allCategories","categories","subCategories","sectionlist","productDeleteId","productErrorMsg","check","removeHtmlEntites","value","multiple","char","before","after","pattern","RegExp","replace","getAllCategories","page","state","formData","data","dat","name","categories_name","id","categories_id","push","parent_id","length","undefined","CHILD","map","key","parent","saveLocalDataIntoArrays","val","SyncStorage","getAllKeys","includes","tempArray","get","row","cartTotalItems","productsTotal","removeWishList","p","forEach","index","splice","set","addWishList","addToRecent","products_id","found","removeRecent","convertHtmlTag","htmlprice","s","addToCart","product","attArray","t","productQuantity","attributesArray","attributes","att","products_options_id","option","products_options","products_options_values_id","values","options_values_price","price","price_prefix","products_options_values","pprice","products_price","onSale","discount_price","flash_price","finalPrice","calculateFinalPriceService","parseFloat","obj","cart_id","parseInt","toString","manufacture","manufacturers_name","customers_basket_quantity","final_price","model","products_model","weight","products_weight","on_sale","unit","products_weight_unit","image","products_image","products_name","subtotal","total","attPrice","alreadyInCart","vId","quantity","count","type","product_id","Number","variation_id","checkCart","onlyOneAllowed","quantityCheck","sold_individually","console","log","stock_quantity","cartItems","action","payload","index1","OnScreen","msg","filter","cartItem"],"mappings":"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","sourcesContent":["import SyncStorage from 'sync-storage'\nimport { getUrl, postHttp } from '../../common/WooComFetch'\nconst initialState = {\n  wishListProducts: [],\n  recentViewedProducts: [],\n  tempArr: [],\n  cartProductArray: [],\n  cartquantity: 0,\n  subTotal: [],\n  totalSumPrice: 0,\n  spinerTemp: false,\n  indicatorTemp: false,\n  spinnerArray: [],\n  removerecentCondition: false,\n  onScreen: false,\n  couponArray: [],\n  allCategories: [],\n  categories: [],\n  subCategories: [],\n  sectionlist: [],\n  productDeleteId: 0,\n  productErrorMsg: '',\n  check: false\n}\n/// /////////////////////////\nremoveHtmlEntites = value => {\n  const multiple = {\n    '&nbsp;': ' ',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&amp;': '&',\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&cent;': '¢',\n    '&pound;': '£',\n    '&yen;': '¥',\n    '&euro;': '€',\n    '&copy;': '©',\n    '&reg;': '®',\n    '&#160;': ' ',\n    '&#60;': '<',\n    '&#62;': '>',\n    '&#38;': '&',\n    '&#34;': '\"',\n    '&#39;': \"'\",\n    '&#162;': '¢',\n    '&#163;': '£',\n    '&#165;': '¥',\n    '&#8364;': '€',\n    '&#169;': '©',\n    '&#174;': '®'\n  }\n  for (const char in multiple) {\n    const before = char\n    const after = multiple[char]\n    const pattern = new RegExp(before, 'g')\n    value = value.replace(pattern, after)\n  }\n  return value\n}\n/// ////////////////////////////////////////////////////////////\ngetAllCategories = async (page, state, formData) => {\n  state.allCategories = []\n  state.categories = []\n  const data = await postHttp(getUrl() + '/api/' + 'allcategories', formData)\n  const dat = data.data\n\n  for (const value of dat) {\n    value.name = value.categories_name\n    value.id = value.categories_id\n    state.allCategories.push(value)\n    if (value.parent_id === 0) {\n      state.categories.push(value)\n    } else {\n      state.subCategories.push(value)\n    }\n  }\n  if (dat.length === 0) {\n  }\n  if (state.categories === undefined || state.categories.length === 0) {\n  } else {\n    let CHILD = []\n    state.categories.map(key => {\n      for (const value of state.allCategories) {\n        if (value.parent_id === key.categories_id) {\n          CHILD.push(value)\n        }\n      }\n      state.sectionlist.push({\n        data: CHILD,\n        parent: key\n      })\n      CHILD = []\n    })\n  }\n}\n/// /////////////////////////////////////////////////////////////////\n\nsaveLocalDataIntoArrays = state => {\n  state.cartProductArray = [] /// //////////////////////////////////////////////last change\n  const val = SyncStorage.getAllKeys().includes('cartProducts')\n  if (val != null) {\n    const tempArray = SyncStorage.get('cartProducts')\n    if (tempArray != null) {\n      tempArray.map(row => {\n        state.cartProductArray.push(row)\n        this.cartTotalItems(state)\n        this.productsTotal(state)\n      })\n    }\n  }\n}\n\n/// /////////////////////////////////////////////////\nremoveWishList = (p, state) => {\n  state.wishListProducts.forEach((value, index) => {\n    if (value.id === p.id) {\n      state.wishListProducts.splice(index, 1)\n      SyncStorage.set('wishListProducts', state.wishListProducts)\n    }\n  })\n}\naddWishList = (p, state) => {\n  state.wishListProducts.push(p)\n  SyncStorage.set('wishListProducts', state.wishListProducts)\n}\n/// ////////////////////////////////////////////////\n\n// adding into recent array products\naddToRecent = (p, state) => {\n  if (state.recentViewedProducts === undefined) {\n    state.recentViewedProducts.push(p)\n    state.tempArr.push(p.products_id)\n    SyncStorage.set('recentViewedProducts', state.tempArr)\n  } else {\n    let found = false\n    for (const value of state.recentViewedProducts) {\n      if (value.id === p.id) {\n        found = true\n      }\n    }\n    if (found === false) {\n      state.recentViewedProducts.push(p)\n      state.tempArr.push(p.products_id)\n      SyncStorage.set('recentViewedProducts', state.tempArr)\n    }\n  }\n}\n// removing from recent array products\nremoveRecent = (p, state) => {\n  state.recentViewedProducts.forEach((value, index) => {\n    if (value.id === p.id) {\n      state.recentViewedProducts.splice(index, 1)\n      SyncStorage.set('recentViewedProducts', state.recentViewedProducts)\n    }\n  })\n}\n\n/// /////////////////////////////////////////////////\nconvertHtmlTag = htmlprice => {\n  let s = htmlprice\n  s = s.replace(/<del>/, '<s>')\n  s = s.replace(/<\\/del>/, '</s>')\n  return s\n}\n// adding into cart array products\n/// /////////////\naddToCart = (state, product, attArray, t, productQuantity) => {\n  let attributesArray = attArray\n  if (attArray.length === 0 || attArray == null) {\n    attributesArray = []\n    if (product.attributes !== undefined) {\n      product.attributes.forEach((value, index) => {\n        const att = {\n          products_options_id: value.option.id,\n          products_options: value.option.name,\n          products_options_values_id: value.values[0].id,\n          options_values_price: value.values[0].price,\n          price_prefix: value.values[0].price_prefix,\n          products_options_values: value.values[0].value,\n          name:\n            value.values[0].value +\n            ' ' +\n            value.values[0].price_prefix +\n            value.values[0].price +\n            ' ' +\n            SyncStorage.get('currency')\n        }\n        attributesArray.push(att)\n      })\n    }\n  }\n  let pprice = product.products_price\n  let onSale = false\n  if (product.discount_price != null) {\n    pprice = product.discount_price\n    onSale = true\n  }\n  if (product.flash_price != null) {\n    pprice = product.flash_price\n  }\n  const finalPrice =\n    t.calculateFinalPriceService(attributesArray) + parseFloat(pprice)\n  const obj = {\n    cart_id: parseInt(product.products_id.toString() + state.cartProductArray.length.toString()),\n    products_id: product.products_id,\n    manufacture: product.manufacturers_name,\n    customers_basket_quantity: 1,\n    final_price: finalPrice,\n    model: product.products_model,\n    categories: product.categories,\n    weight: product.products_weight,\n    on_sale: onSale,\n    unit: product.products_weight_unit,\n    image: product.products_image,\n    attributes: attributesArray,\n    products_name: product.products_name,\n    price: pprice,\n    subtotal: finalPrice,\n    total: finalPrice\n  }\n  state.cartProductArray.push(obj)\n  t.cartTotalItems(state)\n  SyncStorage.set('cartProducts', state.cartProductArray)\n}\n\n/// ////////////////////////\n\ncalculateFinalPriceService = attArray => {\n  let total = 0\n  attArray.forEach((value, index) => {\n    const attPrice = parseFloat(value.options_values_price)\n    if (value.price_prefix === '+') {\n      total += attPrice\n    } else {\n      total -= attPrice\n    }\n  })\n  return total\n}\n/// //////////////////////\nalreadyInCart = (state, p, vId, quantity) => {\n  let count = 0\n  for (const value of state.cartProductArray) {\n    if (p.type !== 'variable' && value.product_id === Number(p.id)) {\n      count++\n      value.quantity = Number(value.quantity) + Number(quantity)\n    } else if (\n      value.product_id == Number(p.id) &&\n      value.variation_id == Number(p.id)\n    ) {\n      count++\n      value.quantity = Number(value.quantity) + Number(quantity)\n    }\n  }\n  this.cartTotalItems(state)\n  this.productsTotal(state)\n  SyncStorage.set('cartProducts', state.cartProductArray)\n  if (count !== 0) return true\n  return false\n}\n\n/// ////////////////////////\ncheckCart = (state, p, quantity) => {\n  let name = null\n  let onlyOneAllowed = true\n  let quantityCheck = true\n  // check for only one item is allowed\n  for (const value of state.cartProductArray) {\n    if (value.sold_individually == true && p.id == value.product_id) {\n      onlyOneAllowed = false\n      name = value.name\n    }\n  }\n  if (onlyOneAllowed === false) console.log(\"'Only One Item Allowed'\")\n  if (quantity == null) quantity = 1\n\n  if (p.stock_quantity == null || p.stock_quantity > quantity) {\n    quantityCheck = true\n  } else if (p.stock_quantity < quantity) {\n    quantityCheck = false\n  }\n\n  if (onlyOneAllowed && quantityCheck) return true\n  return false\n}\n\n/// /////////////////////////////\ncartTotalItems = state => {\n  let total = 0\n  for (const value of state.cartProductArray) {\n    total += Number(value.customers_basket_quantity)\n  }\n  state.cartquantity = total\n  return total\n}\n/// ///////////////////////////////\nproductsTotal = state => {\n  let total = 0\n  state.cartProductArray.map((val, key) => {\n    // subTotal\n    state.cartProductArray[key].subTotal = parseFloat(val.quantity * val.price)\n    total += parseFloat(state.cartProductArray[key].subTotal)\n  })\n  state.totalSumPrice = parseFloat(total)\n}\n/// /////////////////////////////\nconst cartItems = (state = initialState, action) => {\n  switch (action.type) {\n    case 'GET_ALL_CATEGORIES':\n      this.getAllCategories(1, state, action.payload)\n\n      return {\n        ...state\n      }\n    case 'SPLICE':\n      state.cartProductArray.splice(action.index, 1)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'CART_TOTAL_ITEMS':\n      this.cartTotalItems(state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'PRODUCT_TOTAL':\n      this.productsTotal(state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'UPDATE_PRODUCTS':\n      state.cartProductArray = [action.product]\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'REMOVE_WISHLIST_PRODUCTS':\n      this.removeWishList(action.product, state)\n      return {\n        ...state\n      }\n      /// /////////////////////////////////////////////////\n\n    case 'ADD_WISHLIST_PRODUCTS':\n      this.addWishList(action.product, state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'REMOVE_RECENT':\n      this.removeRecent(action.product, state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'ADD_RECENT':\n      this.addToRecent(action.product, state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'SAVE_LOCAL_DATA_INTO_ARRAYS':\n      this.saveLocalDataIntoArrays(state)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'REMOVE_SPINNER':\n      state.spinnerArray.map((val, key) => {\n        state.spinnerArray[key] = null\n      })\n      state.spinnerArray = []\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'MY_SPINNER':\n      state.spinnerArray[action.index1] = action.value\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'SET_INDICATOR':\n      state.indicatorTemp = action.value\n      state.onScreen = action.OnScreen\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'SET_SPINNER':\n      state.spinerTemp = action.value\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'ADD_TO_CARTS':\n      this.addToCart(\n        state,\n        action.product,\n        action.attributes,\n        this,\n        action.productQuantity\n      )\n      return {\n        ...state\n      }\n      /// /////////////////////////////////////////////////\n    case 'CLEAR_RECENT_PRODUCT':\n      state.recentViewedProducts = []\n      return {\n        ...state\n      }\n      /// /////////////////////////////////////////////////\n    case 'OUT_OF_STOCK_PRODUCT':\n      state.productDeleteId = action.productDeleteId\n      state.productErrorMsg = action.msg\n      state.check = action.check\n      return {\n        ...state\n      }\n      /// /////////////////////////////////////////////////\n    case 'SET_CHECK':\n      state.check = false\n      return {\n        ...state\n      }\n      /// /////////////////////////////////////////////////\n    case 'CLEAR_CART':\n      state.cartProductArray = []\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'ADD_TO_CARTS_QUANTITY':\n      state.cartProductArray.map((val, key) => {\n        if (val.cart_id === action.product.cart_id) {\n          state.cartProductArray[key].quantity++\n        }\n      })\n\n      this.cartTotalItems(state)\n      this.productsTotal(state)\n      SyncStorage.set('cartProducts', state.cartProductArray)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'REMOVE_TO_CARTS_QUANTITY':\n      state.cartProductArray.map((val, key) => {\n        if (val.cart_id === action.product.cart_id) {\n          state.cartProductArray[key].quantity--\n        }\n      })\n\n      this.cartTotalItems(state)\n      this.productsTotal(state)\n      SyncStorage.set('cartProducts', state.cartProductArray)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n    case 'REMOVE_CARD_FROM_CART':\n      state.cartProductArray = state.cartProductArray.filter(\n        cartItem => cartItem.cart_id !== action.product.cart_id\n      )\n\n      this.cartTotalItems(state)\n      this.productsTotal(state)\n      SyncStorage.set('cartProducts', state.cartProductArray)\n      return {\n        ...state\n      }\n    /// /////////////////////////////////////////////////\n  }\n  return state\n}\n\nexport default cartItems\n"]},"metadata":{},"sourceType":"script"}